<div
  class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-8 animate-fade-in"
>
  <div class="mb-10 text-center">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Post Your Project</h1>
    <p class="text-lg text-gray-600">
      Find the perfect professional for your needs
    </p>
    <div class="mt-4 h-1 w-24 bg-yellow-400 mx-auto rounded-full"></div>
  </div>

  <form class="space-y-8" (ngSubmit)="onSubmit()">
    <!-- Project Type Selection -->
    <div
      class="bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200"
    >
      <h2 class="text-xl font-semibold text-gray-800 mb-4">
        What type of project do you need?
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <button
          type="button"
          class="p-5 border-2 rounded-xl transition-all hover:shadow-md"
          [class.border-yellow-400]="projectType === 'writing'"
          [class.border-gray-200]="projectType !== 'writing'"
          [class.bg-yellow-50]="projectType === 'writing'"
          (click)="projectType = 'writing'"
        >
          <div class="flex items-center space-x-4">
            <div class="p-3 bg-yellow-100 rounded-lg">
              <svg
                class="w-8 h-8 text-yellow-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                ></path>
              </svg>
            </div>
            <div class="text-left">
              <h3 class="font-medium text-lg text-gray-800">Writing Project</h3>
              <p class="text-gray-600">Articles, research, academic papers</p>
            </div>
          </div>
        </button>

        <button
          type="button"
          class="p-5 border-2 rounded-xl transition-all hover:shadow-md"
          [class.border-indigo-400]="projectType === 'software'"
          [class.border-gray-200]="projectType !== 'software'"
          [class.bg-indigo-50]="projectType === 'software'"
          (click)="projectType = 'software'"
        >
          <div class="flex items-center space-x-4">
            <div class="p-3 bg-indigo-100 rounded-lg">
              <svg
                class="w-8 h-8 text-indigo-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
                ></path>
              </svg>
            </div>
            <div class="text-left">
              <h3 class="font-medium text-lg text-gray-800">
                Software Project
              </h3>
              <p class="text-gray-600">Web, mobile, or desktop applications</p>
            </div>
          </div>
        </button>
      </div>
    </div>

    <!-- Main Form -->
    <div *ngIf="projectType" class="space-y-8">
      <!-- Basic Info -->
      <div class="space-y-2">
        <label class="block text-lg font-medium text-gray-700"
          >Project Title*</label
        >
        <input
          type="text"
          [(ngModel)]="formData.projectTitle"
          name="projectTitle"
          required
          class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          placeholder="e.g. Need a research paper on Kenyan history"
        />
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Category*</label
          >
          <select
            [(ngModel)]="formData.category"
            name="category"
            required
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          >
            <option value="" disabled selected>Select a category</option>
            <option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </option>
          </select>
        </div>
        <!-- 
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700">Due Date*</label>
          <input
            type="date"
            [(ngModel)]="formData.dueDateTime"
            name="dueDateTime"
            required
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          />
        </div> -->

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Due Date & Time*</label
          >
          <div class="grid grid-cols-2 gap-3">
            <input
              type="date"
              [(ngModel)]="formData.dueDate"
              name="dueDate"
              required
              class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
            />
            <input
              type="time"
              [(ngModel)]="formData.dueTime"
              name="dueTime"
              required
              class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="space-y-2">
      <label class="block text-lg font-medium text-gray-700"
        >Description*</label
      >
      <textarea
        rows="6"
        [(ngModel)]="formData.description"
        name="description"
        required
        class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
        placeholder="Describe your project in detail..."
      ></textarea>
    </div>

    <!-- Writing Specific Fields -->
    <div
      *ngIf="projectType === 'writing'"
      class="bg-yellow-50 p-6 rounded-xl border border-yellow-100 space-y-6"
    >
      <h3 class="text-xl font-semibold text-gray-800 flex items-center">
        <svg
          class="w-6 h-6 text-yellow-600 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
          ></path>
        </svg>
        Writing Details
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Number of pages</label
          >
          <input
            type="number"
            [(ngModel)]="formData.numberOfPages"
            name="numberOfPages"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
            placeholder="Number of pages"
          />
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Citation Style</label
          >
          <select
            [(ngModel)]="formData.citationStyle"
            name="citationStyle"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          >
            <option>APA</option>
            <option>MLA</option>
            <option>Chicago</option>
            <option>Harvard</option>
            <option>IEEE</option>
          </select>
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Writing Level</label
          >
          <select
            [(ngModel)]="formData.writingLevel"
            name="writingLevel"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          >
            <option>High School</option>
            <option>College</option>
            <option>Undergraduate</option>
            <option>Master's</option>
            <option>PhD</option>
          </select>
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Number of Sources</label
          >
          <input
            type="number"
            [(ngModel)]="formData.numberOfSources"
            name="numberOfSources"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
            placeholder="Minimum required sources"
          />
        </div>
      </div>

      <div class="space-y-2">
        <label class="block text-lg font-medium text-gray-700"
          >Specific Topic/Thesis</label
        >
        <input
          type="text"
          [(ngModel)]="formData.specificTopic"
          name="specificTopic"
          class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          placeholder="Your specific topic or thesis statement"
        />
      </div>
    </div>

    <!-- Software Specific Fields -->
    <div
      *ngIf="projectType === 'software'"
      class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 space-y-6"
    >
      <h3 class="text-xl font-semibold text-gray-800 flex items-center">
        <svg
          class="w-6 h-6 text-indigo-600 mr-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
          ></path>
        </svg>
        Technical Details
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Programming Languages</label
          >
          <input
            type="text"
            [(ngModel)]="formData.programmingLanguages"
            name="programmingLanguages"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="e.g. JavaScript, Python, PHP"
          />
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Framework/Stack</label
          >
          <input
            type="text"
            [(ngModel)]="formData.framework"
            name="framework"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="e.g. React, Django, Laravel"
          />
        </div>
      </div>

      <div class="space-y-2">
        <label class="block text-lg font-medium text-gray-700"
          >Requirements</label
        >
        <textarea
          rows="4"
          [(ngModel)]="formData.requirements"
          name="requirements"
          class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
          placeholder="Describe the main features you need..."
        ></textarea>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Repository URL (if any)</label
          >
          <input
            type="url"
            [(ngModel)]="formData.repositoryUrl"
            name="repositoryUrl"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="e.g. GitHub, GitLab link"
          />
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700">Hosting</label>
          <input
            type="text"
            [(ngModel)]="formData.hosting"
            name="hosting"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="e.g. AWS, Digital Ocean"
          />
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Deployment</label
          >
          <input
            type="text"
            [(ngModel)]="formData.deployment"
            name="deployment"
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            placeholder="e.g. Docker, Kubernetes"
          />
        </div>
      </div>
    </div>

    <!-- Budget Section -->
    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
      <h3 class="text-xl font-semibold text-gray-800 mb-4">Budget Details</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Currency</label
          >
          <select
            [(ngModel)]="formData.currency"
            name="currency"
            required
            class="mt-2 block w-full px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
          >
            <option value="KES">Kenyan Shilling (KES)</option>
          </select>
        </div>

        <div class="space-y-2">
          <label class="block text-lg font-medium text-gray-700"
            >Payment Budget*</label
          >
          <div class="mt-2 relative rounded-xl shadow-sm">
            <div
              class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"
            >
              <span class="text-gray-600 text-lg"></span>
            </div>
            <input
              type="number"
              [(ngModel)]="formData.paymentBudget"
              name="paymentBudget"
              required
              class="block w-full pl-16 px-4 py-3 text-lg rounded-xl border border-gray-300 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"
              placeholder=""
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Attachments -->
    <div class="space-y-2">
      <label class="block text-lg font-medium text-gray-700">Attachments</label>
      <div
        class="mt-2 flex justify-center px-8 pt-8 pb-10 border-2 border-dashed border-gray-300 rounded-xl hover:border-yellow-400 transition-colors"
      >
        <div class="space-y-3 text-center">
          <svg
            class="mx-auto h-14 w-14 text-gray-400"
            stroke="currentColor"
            fill="none"
            viewBox="0 0 48 48"
          >
            <path
              d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></path>
          </svg>
          <div class="flex justify-center text-lg text-gray-600">
            <label
              class="relative cursor-pointer bg-white rounded-xl font-medium text-yellow-600 hover:text-yellow-500 focus-within:outline-none"
            >
              <span>Upload files</span>
              <input
                type="file"
                (change)="handleFileInput($event)"
                name="files"
                multiple
                class="sr-only"
              />
            </label>
            <p class="pl-2">or drag and drop</p>
          </div>
          <p class="text-sm text-gray-500">PDF, DOCX, ZIP up to 10MB</p>
        </div>
      </div>
    </div>

    <!-- Submit -->
  <div class="pt-6 flex justify-between items-center">
  <!-- Left side - Load Draft button (only shows when draft exists) -->
  <div>
    <button
      *ngIf="hasDraft()"
      type="button"
      (click)="loadDraft()"
      class="px-6 py-3 border border-blue-300 rounded-xl text-lg font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
    >
      Load Saved Draft
    </button>
  </div>

  <!-- Right side - Save Draft and Post Project buttons -->
  <div class="flex space-x-4">
    <button
      type="button"
      (click)="onSubmit(true)"
      class="px-8 py-3.5 border border-gray-300 rounded-xl text-lg font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500"
    >
      Save Draft
    </button>
    
    <button
      type="submit"
      class="px-8 py-3.5 border border-transparent rounded-xl shadow-sm text-lg font-medium text-white bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500"
    >
      Post Project
    </button>
  </div>
</div>
    
  </form>

  <!-- Payment Information Modal -->
  <div
    *ngIf="showPaymentInfoModal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
  >
    <div class="bg-white rounded-2xl p-8 max-w-2xl w-full animate-fade-in">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Payment Information</h2>

      <div class="space-y-4 mb-6">
        <p class="text-gray-700">
          Before your project is posted, you'll need to pay the total amount
          (KES {{ formData.paymentBudget }}) into escrow.
        </p>
        <p class="text-gray-700">
          You'll receive an STK push to complete this payment. The funds will be
          held securely until:
        </p>
        <ul class="list-disc pl-6 text-gray-700 space-y-2">
          <li>The freelancer completes the work to your satisfaction</li>
          <li>You approve the delivery</li>
          <li>The funds will then be released to the freelancer</li>
        </ul>
        <p class="text-gray-700 font-medium">
          This protects both you and the freelancer, ensuring payment only
          occurs for satisfactory work.
        </p>
      </div>

      <div class="flex justify-end space-x-4">
        <button
          type="button"
          (click)="showPaymentInfoModal = false"
          class="px-6 py-2.5 border border-gray-300 rounded-xl text-lg font-medium text-gray-700 bg-white hover:bg-gray-50"
        >
          Cancel
        </button>
        <button
          type="button"
          (click)="confirmPostProject()"
          class="px-6 py-2.5 border border-transparent rounded-xl shadow-sm text-lg font-medium text-white bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700"
        >
          I Understand - Post Project
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div
    *ngIf="isLoading"
    class="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50"
  >
    <div class="bg-white p-8 rounded-xl shadow-xl flex flex-col items-center">
      <div
        class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-yellow-500 mb-4"
      ></div>
      <p class="text-lg text-gray-700">Posting your project...</p>
    </div>
  </div>
</div>
